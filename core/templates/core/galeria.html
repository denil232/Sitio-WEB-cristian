{% extends 'core/base.html' %}
{% load static %}

{% block title %}Inicio - Arte de Cristian Err√©{% endblock %}

{% block content %}
<style>
    /* === TU CSS ORIGINAL (INTACTO) === */
    body { background-color: #f5f2ee; color: #333; font-family: 'Poppins', sans-serif; }
    .section { padding: 60px 20px; max-width: 1100px; margin: auto; }
    .section h2 { text-align: center; font-size: 2.2rem; font-weight: 600; margin-bottom: 10px; }
    .section p.subtitle { text-align: center; font-style: italic; margin-bottom: 40px; color: #666; }

    /* Buscador y Controles */
    .catalog-controls { display: flex; flex-direction: column; align-items: center; margin-bottom: 40px; }
    .search-container { width: 100%; max-width: 500px; margin-bottom: 20px; text-align: center; }
    .search-container input[type="text"] { width: 100%; padding: 12px 20px; border: 1px solid #ccc; border-radius: 25px; font-size: 1rem; box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05); }
    
    /* Bot√≥n descarga */
    .download-area { width: 100%; max-width: 500px; text-align: center; padding-bottom: 20px; border-bottom: 1px solid #eee; margin-bottom: 20px; }
    .download-text { font-size: 0.9rem; color: #555; margin-bottom: 15px; }
    .download-button { text-decoration: none; background-color: #2a2a2a; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer; font-size: 1rem; font-weight: 500; display: inline-flex; align-items: center; gap: 8px; }
    .download-button:hover { background-color: #555; transform: translateY(-2px); }

    /* Galer√≠a */
    .gallery { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 30px; }
    
    .art-card { background-color: #fff; border-radius: 15px; overflow: hidden; box-shadow: 0 6px 15px rgba(0, 0, 0, 0.15); transition: transform 0.4s ease, box-shadow 0.4s ease; display: flex; flex-direction: column; height: 100%; }
    .art-card:hover { transform: translateY(-6px); box-shadow: 0 10px 25px rgba(0, 0, 0, 0.25); }
    
    .art-card img { width: 100%; height: 280px; object-fit: cover; }
    
    .art-info { padding: 20px; flex-grow: 1; display: flex; flex-direction: column; justify-content: space-between; }
    .art-info h3 { font-size: 1.4rem; font-weight: 600; margin-bottom: 10px; color: #222; text-transform: uppercase; }
    .art-info p { font-size: 0.95rem; color: #555; line-height: 1.6; margin-bottom: 10px; }

    /* Etiquetas de Estado */
    .status { display: inline-block; padding: 5px 12px; border-radius: 20px; font-size: 0.85rem; font-weight: 600; color: white; margin-top: auto; align-self: flex-start;}
    .status.disponible { background-color: #4caf50; }
    .status.reservado { background-color: #ff9800; }
    .status.vendido { background-color: #d32f2f; }

    /* Estilos nuevos para botones de Admin */
    .admin-actions { margin-top: 15px; padding-top: 10px; border-top: 1px solid #eee; display: flex; gap: 10px; justify-content: center; }
    .btn-editar { background-color: #0d6efd; color: white; padding: 5px 10px; border-radius: 5px; text-decoration: none; font-size: 0.8rem; }
    .btn-eliminar { background-color: #dc3545; color: white; padding: 5px 10px; border-radius: 5px; text-decoration: none; font-size: 0.8rem; }
</style>

<section class="section">
    <h2>Dibujos sobre cuadros</h2>
    <p class="subtitle">Obras que se expusieron en Sala de Obra</p>

    <div class="catalog-controls">
        
        <div class="search-container">
            <input type="text" id="searchInput" onkeyup="filterArtworks()" placeholder="Buscar obras por nombre...">
        </div>
        
        <div class="download-area">
            <p class="download-text">Haz clic para **ver y descargar el cat√°logo completo en PDF** üñºÔ∏è</p>
            <a href="https://drive.google.com/file/d/1yULWvfxzVaW6LP-HBlzLeAnXsgCuu0Tl/view?fbclid=PAZXh0bgNhZW0CMTEAAacXBEIWhnOwpCWpH2WkkFMhd0MDNsfDvIy-DGEHDMNkUbiaaP3pDMYFfJHcLA_aem_jdu1OKUsGgkbeDyO8hY7AA" target="_blank" class="download-button">
                ‚¨áÔ∏è Ver y Descargar Cat√°logo PDF
            </a>
        </div>
        
    </div>

    <div class="gallery" id="artGallery">
        
        {% for obra in obras %}
        <div class="art-card">
            
            {% if obra.imagen %}
                <img src="{{ obra.imagen.url }}" alt="{{ obra.titulo }}">
            {% else %}
                <img src="https://via.placeholder.com/300x280?text=Sin+Imagen" alt="Sin imagen">
            {% endif %}

            <div class="art-info">
                <h3>{{ obra.titulo }}</h3>
                <p>{{ obra.descripcion }}</p>

                {% if obra.estado == 'vendido' %}
                    <span class="status vendido">VENDIDO</span>
                {% elif obra.estado == 'reservado' %}
                    <span class="status reservado">RESERVADO</span>
                {% else %}
                    <span class="status disponible">DISPONIBLE</span>
                {% endif %}

                {% if user.is_staff %}
                <div class="admin-actions">
                    <a href="{% url 'editar_obra' obra.id %}" class="btn-editar">Editar</a>
                    <a href="{% url 'eliminar_obra' obra.id %}" class="btn-eliminar" onclick="return confirm('¬øBorrar esta obra?');">Eliminar</a>
                </div>
                {% endif %}

            </div>
        </div>
        {% empty %}
            <p style="text-align: center; width: 100%;">No hay obras cargadas todav√≠a.</p>
        {% endfor %}
        </div>
</section>

<script>
    // Tu script de b√∫squeda original (funciona igual con las tarjetas din√°micas)
    function filterArtworks() {
        const input = document.getElementById('searchInput');
        const filter = input.value.toUpperCase();
        const gallery = document.getElementById('artGallery');
        const cards = gallery.getElementsByClassName('art-card');
        
        for (let i = 0; i < cards.length; i++) {
            const h3 = cards[i].querySelector('.art-info h3');
            if (h3) {
                const titleText = h3.textContent || h3.innerText;
                if (titleText.toUpperCase().indexOf(filter) > -1) {
                    cards[i].style.display = "";
                } else {
                    cards[i].style.display = "none";
                }
            }
        }
    }
</script>
{% endblock %}